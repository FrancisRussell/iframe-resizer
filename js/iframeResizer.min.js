/*! iFrame Resizer (iframeSizer.min.js ) - v3.5.1 - 2015-11-04
 *  Desc: Force cross domain iframes to size to content.
 *  Requires: iframeResizer.contentWindow.min.js to be loaded into the target frame.
 *  Copyright: (c) 2015 David J. Bradshaw - dave@bradshaw.net
 *  License: MIT
 */


(function(f){function q(a,b,e){"addEventListener"in f?a.addEventListener(b,e,!1):"attachEvent"in f&&a.attachEvent("on"+b,e)}function P(a,b,e){"removeEventListener"in f?a.removeEventListener(b,e,!1):"detachEvent"in f&&a.detachEvent("on"+b,e)}function Q(){var a=["moz","webkit","o","ms"],b;for(b=0;b<a.length&&!r;b+=1)r=f[a[b]+"RequestAnimationFrame"];r||k("setup","RequestAnimationFrame not supported")}function R(a){var b="Host page: "+a;f.top!==f.self&&(b=f.parentIFrame&&f.parentIFrame.getId?f.parentIFrame.getId()+
": "+a:"Nested host page: "+a);return b}function k(a,c){z("log",a,c,b[a]?b[a].log:A)}function x(a,b){z("warn",a,b,!0)}function z(a,b,e,d){if(!0===d&&"object"===typeof f.console)console[a]("[iFrameSizer]["+R(b)+"]",e)}function S(a){function c(){d("Height");d("Width");E(function(){F(l);G(g)},l,"init")}function e(){var a=n.substr(13).split(":");return{iframe:b[a[0]].iframe,id:a[0],height:a[1],width:a[2],type:a[3]}}function d(a){var d=Number(b[g]["max"+a]),e=Number(b[g]["min"+a]);a=a.toLowerCase();var c=
Number(l[a]);k(g,"Checking "+a+" is in range "+e+"-"+d);c<e&&(c=e,k(g,"Set "+a+" to min value"));c>d&&(c=d,k(g,"Set "+a+" to max value"));l[a]=""+c}function T(){function d(){function a(){var b=0,d=!1;for(k(g,"Checking connection is from allowed list of origins: "+e);b<e.length;b++)if(e[b]===c){d=!0;break}return d}function f(){var a=b[g].remoteHost;k(g,"Checking connection is from: "+a);return c===a}return e.constructor===Array?a():f()}var c=a.origin,e=b[g].checkOrigin;if(e&&"null"!==""+c&&!d())throw Error("Unexpected message received from: "+
c+" for "+l.iframe.id+". Message was: "+a.data+". This error can be disabled by setting the checkOrigin: false option or by providing of array of trusted domains.");return!0}function r(){var a=l.type in{"true":1,"false":1,undefined:1};a&&k(g,"Ignoring init message from meta parent page");return a}function h(a){k(g,"MessageCallback passed: {iframe: "+l.iframe.id+", message: "+a+"}");a={iframe:l.iframe,message:JSON.parse(a)};u(g,"messageCallback",a);k(g,"--")}function H(a,b){B(function(){var d=p,c;
c=document.body.getBoundingClientRect();var e=l.iframe.getBoundingClientRect();c=JSON.stringify({clientHeight:Math.max(document.documentElement.clientHeight,f.innerHeight||0),clientWidth:Math.max(document.documentElement.clientWidth,f.innerWidth||0),offsetTop:parseInt(e.top-c.top,10),offsetLeft:parseInt(e.left-c.left,10),scrollTop:f.pageYOffset,scrollLeft:f.pageXOffset});d("Send Page Info","pageInfo:"+c,a,b)},32)}function U(){function a(e,g){function h(){b[c]?H(b[c].iframe,c):d()}["scroll","resize"].forEach(function(a){k(c,
e+a+" listener for sendPageInfo");g(f,a,h)})}function d(){a("Remove ",P)}var c=g;a("Add ",q);b[c].stopPageInfo=d}function V(){var a=!0;null===l.iframe&&(x(g,"IFrame ("+l.id+") not found"),a=!1);return a}function t(a){a=a.getBoundingClientRect();I(g);return{x:Math.floor(Number(a.left)+Number(m.x)),y:Math.floor(Number(a.top)+Number(m.y))}}function v(a){var b=a?t(l.iframe):{x:0,y:0},c={x:Number(l.width)+b.x,y:Number(l.height)+b.y};k(g,"Reposition requested from iFrame (offset x:"+b.x+" y:"+b.y+")");
if(f.top!==f.self)if(f.parentIFrame)f.parentIFrame["scrollTo"+(a?"Offset":"")](c.x,c.y);else x(g,"Unable to scroll to requested position, window.parentIFrame not found");else m=c,w(),k(g,"--")}function w(){!1!==u(g,"scrollCallback",m)?G(g):m=null}function y(a){a=a.split("#")[1]||"";var b=decodeURIComponent(a);(b=document.getElementById(b)||document.getElementsByName(b)[0])?(b=t(b),k(g,"Moving to in page link (#"+a+") at x: "+b.x+" y: "+b.y),m={x:b.x,y:b.y},w(),k(g,"--")):f.top!==f.self?f.parentIFrame?
f.parentIFrame.moveToAnchor(a):k(g,"In page link #"+a+" not found and window.parentIFrame not found"):k(g,"In page link #"+a+" not found")}function C(a){var c=!0;b[a]||(c=!1,x(l.type+" No settings for "+a+". Message was: "+n));return c}function D(){for(var a in b)p("iFrame requested init",J(a),document.getElementById(a),a)}var n=a.data,l={},g=null;if("[iFrameResizerChild]Ready"===n)D();else if("[iFrameSizer]"===(""+n).substr(0,13)&&n.substr(13).split(":")[0]in b){if(l=e(),g=l.id,!r()&&C(g)&&(k(g,
"Received: "+n),V()&&T()))switch(b[g].firstRun&&(b[g].firstRun=!1),l.type){case "close":K(l.iframe);break;case "message":h(n.substr(n.indexOf(":")+7+6));break;case "scrollTo":v(!1);break;case "scrollToOffset":v(!0);break;case "pageInfo":H(b[g].iframe,g);U();break;case "pageInfoStop":b[g]&&b[g].stopPageInfo&&(b[g].stopPageInfo(),delete b[g].stopPageInfo);break;case "inPageLink":y(n.substr(n.indexOf(":")+7+9));break;case "reset":L(l);break;case "init":c();u(g,"initCallback",l.iframe);u(g,"resizedCallback",
l);break;default:c(),u(g,"resizedCallback",l)}}else z("info",g,"Ignored: "+n,b[g]?b[g].log:A)}function u(a,c,e){var d=null,d=null;if(b[a])if(d=b[a][c],"function"===typeof d)d=d(e);else throw new TypeError(c+" on iFrame["+a+"] is not a function");return d}function K(a){var c=a.id;k(c,"Removing iFrame: "+c);a.parentNode.removeChild(a);u(c,"closedCallback",c);k(c,"--");delete b[c]}function I(a){null===m&&(m={x:void 0!==f.pageXOffset?f.pageXOffset:document.documentElement.scrollLeft,y:void 0!==f.pageYOffset?
f.pageYOffset:document.documentElement.scrollTop},k(a,"Get page position: "+m.x+","+m.y))}function G(a){null!==m&&(f.scrollTo(m.x,m.y),k(a,"Set page position: "+m.x+","+m.y),m=null)}function L(a){k(a.id,"Size reset requested by "+("init"===a.type?"host page":"iFrame"));I(a.id);E(function(){F(a);p("reset","reset",a.iframe,a.id)},a,"reset")}function F(a){function c(b){a.iframe.style[b]=a[b]+"px";k(a.id,"IFrame ("+e+") "+b+" set to "+a[b]+"px");C||"0"!==a[b]||(C=!0,k(e,"Hidden iFrame detected, creating visibility listener"),
W())}var e=a.iframe.id;b[e]&&(b[e].sizeHeight&&c("height"),b[e].sizeWidth&&c("width"))}function E(a,b,e){e!==b.type&&r?(k(b.id,"Requesting animation frame"),r(a)):a()}function p(a,c,e,d){d=d||e.id;if(b[d])if(e&&"contentWindow"in e&&null!==e.contentWindow){var f=b[d].targetOrigin;k(d,"["+a+"] Sending msg to iframe["+d+"] ("+c+") targetOrigin: "+f);e.contentWindow.postMessage("[iFrameSizer]"+c,f)}else z("info",d,"["+a+"] IFrame("+d+") not found",b[d]?b[d].log:A),b[d]&&delete b[d]}function J(a){return a+
":"+b[a].bodyMarginV1+":"+b[a].sizeWidth+":"+b[a].log+":"+b[a].interval+":"+b[a].enablePublicMethods+":"+b[a].autoResize+":"+b[a].bodyMargin+":"+b[a].heightCalculationMethod+":"+b[a].bodyBackground+":"+b[a].bodyPadding+":"+b[a].tolerance+":"+b[a].inPageLinks+":"+b[a].resizeFrom+":"+b[a].widthCalculationMethod}function D(a,c){function e(){function c(d){Infinity!==b[h][d]&&0!==b[h][d]&&(a.style[d]=b[h][d]+"px",k(h,"Set "+d+" = "+b[h][d]+"px"))}function d(a){if(b[h]["min"+a]>b[h]["max"+a])throw Error("Value for min"+
a+" can not be greater than max"+a);}d("Height");d("Width");c("maxHeight");c("minHeight");c("maxWidth");c("minWidth")}function d(){Function.prototype.bind&&(b[h].iframe.iFrameResizer={close:K.bind(null,b[h].iframe),resize:p.bind(null,"Window resize","resize",b[h].iframe),moveToAnchor:function(a){p("Move to anchor","inPageLink:"+a,b[h].iframe,h)},sendMessage:function(a){a=JSON.stringify(a);p("Send Message","message:"+a,b[h].iframe,h)}})}function f(c){q(a,"load",function(){p("iFrame.onload",c,a);var d=
b[h].heightCalculationMethod in X;!b[h].firstRun&&d&&L({iframe:a,height:0,width:0,type:"init"})});p("init",c,a)}function m(c){c=c||{};b[h]={firstRun:!0,iframe:a,remoteHost:a.src.split("/").slice(0,3).join("/")};if("object"!==typeof c)throw new TypeError("Options is not an object");for(var d in t)t.hasOwnProperty(d)&&(b[h][d]=c.hasOwnProperty(d)?c[d]:t[d]);d=b[h];!0===b[h].checkOrigin?(c=b[h].remoteHost,c=""===c||"file://"===c?"*":c):c="*";d.targetOrigin=c}var h=function(b){""===b&&(b=c&&c.id||t.id+
M++,null!==document.getElementById(b)&&(b+=M++),a.id=b,A=(c||{}).log,k(b,"Added missing iframe ID: "+b+" ("+a.src+")"));return b}(a.id);if(h in b&&"iFrameResizer"in a)x(h,"Ignored iFrame, already setup.");else{m(c);k(h,"IFrame scrolling "+(b[h].scrolling?"enabled":"disabled")+" for "+h);a.style.overflow=!1===b[h].scrolling?"hidden":"auto";a.scrolling=!1===b[h].scrolling?"no":"auto";e();if("number"===typeof b[h].bodyMargin||"0"===b[h].bodyMargin)b[h].bodyMarginV1=b[h].bodyMargin,b[h].bodyMargin=""+
b[h].bodyMargin+"px";f(J(h));d()}}function B(a,b){null===v&&(v=setTimeout(function(){v=null;a()},b))}function W(){function a(){for(var a in b)null===b[a].iframe.offsetParent||"0px"!==b[a].iframe.style.height&&"0px"!==b[a].iframe.style.width||p("Visibility change","resize",b[a].iframe,a)}function c(b){k("window","Mutation observed: "+b[0].target+" "+b[0].type);B(a,16)}function e(){var a=document.querySelector("body");(new d(c)).observe(a,{attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,
childList:!0,subtree:!0})}var d=f.MutationObserver||f.WebKitMutationObserver;d&&e()}function w(a){k("window","Trigger event: "+a);B(function(){N("Window "+a,"resize")},16)}function O(){function a(){N("Tab Visable","resize")}"hidden"!==document.visibilityState&&(k("document","Trigger event: Visiblity change"),B(a,16))}function N(a,c){for(var e in b)"parent"===b[e].resizeFrom&&b[e].autoResize&&!b[e].firstRun&&p(a,c,document.getElementById(e),e)}function Y(){q(f,"message",S);q(f,"resize",function(){w("resize")});
q(document,"visibilitychange",O);q(document,"-webkit-visibilitychange",O);q(f,"focusin",function(){w("focus")});q(f,"focus",function(){w("focus")})}function y(){function a(a,d){if(d){if(!d.tagName)throw new TypeError("Object is not a valid DOM element");if("IFRAME"!==d.tagName.toUpperCase())throw new TypeError("Expected <IFRAME> tag, found <"+d.tagName+">");D(d,a);b.push(d)}}var b;Q();Y();return function(e,d){b=[];switch(typeof d){case "undefined":case "string":Array.prototype.forEach.call(document.querySelectorAll(d||
"iframe"),a.bind(void 0,e));break;case "object":a(e,d);break;default:throw new TypeError("Unexpected data type ("+typeof d+")");}return b}}function Z(a){a.fn.iFrameResize=function(a){return this.filter("iframe").each(function(b,d){D(d,a)}).end()}}var M=0,A=!1,C=!1,m=null,r=f.requestAnimationFrame,X={max:1,scroll:1,bodyScroll:1,documentElementScroll:1},b={},v=null,t={autoResize:!0,bodyBackground:null,bodyMargin:null,bodyMarginV1:8,bodyPadding:null,checkOrigin:!0,inPageLinks:!1,enablePublicMethods:!0,
heightCalculationMethod:"bodyOffset",id:"iFrameResizer",interval:32,log:!1,maxHeight:Infinity,maxWidth:Infinity,minHeight:0,minWidth:0,resizeFrom:"parent",scrolling:!1,sizeHeight:!0,sizeWidth:!1,tolerance:0,widthCalculationMethod:"scroll",closedCallback:function(){},initCallback:function(){},messageCallback:function(){x("MessageCallback function not defined")},resizedCallback:function(){},scrollCallback:function(){return!0}};f.jQuery&&Z(jQuery);"function"===typeof define&&define.amd?define([],y):
"object"===typeof module&&"object"===typeof module.exports?module.exports=y():f.iFrameResize=f.iFrameResize||y()})(window||{});
//# sourceMappingURL=iframeResizer.map
